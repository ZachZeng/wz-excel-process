{"version":3,"sources":["elements/StyledElements.js","components/MyDropzone.js","components/Header.js","components/Layout.js","images/excel.svg","components/FileProcess.js","App.js","serviceWorker.js","index.js"],"names":["LayoutWrapper","styled","div","DropzoneWrapper","props","getColor","isDragAccept","isDragReject","isDragActive","FileProcessWrapper","FilenameWrapper","FilterWrapper","FilterTextWrapper","FilterDateWrapper","ResultWrapper","CalcButton","button","ExportButton","ErrorMessage","MyDropzone","useState","data","setData","onDrop","useCallback","acceptedFiles","f","name","reader","FileReader","onload","evt","bstr","target","result","wb","XLSX","type","cellDates","wsnames","SheetNames","sheet_to_json","Sheets","dateNF","readAsBinaryString","useDropzone","accept","getRootProps","getInputProps","isDragAccepted","rejectedFiles","length","filename","Header","style","fontSize","color","fontWeight","Layout","children","_extends","Object","assign","i","arguments","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","createElement","_ref3","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","_ref","svgRef","title","id","x","y","viewBox","enableBackground","xmlSpace","ref","fill","d","ForwardRef","forwardRef","FileProcess","clients","setClients","brands","setBrands","Date","minDate","setMinDate","maxDate","setMaxDate","currentClient","setCurrentClient","currentBrand","setCurrentBrand","errorMessage","setErrorMessage","filteredData","setFilteredData","startDate","endDate","dateRange","setDateRange","totalNum","setTotalNum","totalAmount","setTotalAmount","useEffect","clientlist","brandlist","datelist","map","item","some","e","value","push","label","includes","unshift","Math","min","max","console","log","replace","marginBottom","options","onChange","onClick","undefined","msg","filteredDate","filter","itemdate","num","amount","客户名","数量","金额","editableDateInputs","selection","moveRangeOnFirstSelection","ranges","rangeColors","json_to_sheet","excelBuffer","bookType","Blob","concat","toLocaleDateString","FileSaver","alert","App","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"igGAEO,IAAMA,EAAgBC,IAAOC,IAAV,KAObC,EAAkBF,IAAOC,IAAV,KAYV,SAAAE,GAAK,OAAIC,EAASD,MAS9BC,EAAW,SAAAD,GACf,OAAIA,EAAME,aACD,UAELF,EAAMG,aACD,UAELH,EAAMI,aACD,UAEF,WAGIC,EAAqBR,IAAOC,IAAV,KAIlBQ,EAAkBT,IAAOC,IAAV,KAkBfS,EAAgBV,IAAOC,IAAV,KAebU,EAAoBX,IAAOC,IAAV,KAQjBW,EAAoBZ,IAAOC,IAAV,KAIjBY,EAAgBb,IAAOC,IAAV,KAcba,EAAad,IAAOe,OAAV,KAgBVC,EAAehB,IAAOe,OAAV,KAiBZE,EAAejB,IAAOC,IAAV,K,OCrIZiB,EAAa,WAAO,IAAD,EACNC,qBADM,mBACvBC,EADuB,KACjBC,EADiB,KAGxBC,EAASC,uBAAY,SAAAC,GACzB,IAAIC,EAAID,EAAc,GACtB,GAAKC,EAAL,CAGWA,EAAEC,KAAb,IACMC,EAAS,IAAIC,WACnBD,EAAOE,OAAS,SAAAC,GAGd,IAAMC,EAAOD,EAAIE,OAAOC,OAOlBC,EAAKC,OAAUJ,EAAM,CACzBK,KAAM,SACNC,WAAW,IAGPC,EAAUJ,EAAGK,WAGbnB,EAAOe,QAAWK,cAAcN,EAAGO,OAAOH,EAAQ,IAAK,CAC3DI,OAAQ,iBAGVrB,EAAQD,IAEVO,EAAOgB,mBAAmBlB,MACzB,IAnC2B,EA6C1BmB,YAAY,CACdtB,SACAuB,OAAQ,UATRtC,EAtC4B,EAsC5BA,aACAuC,EAvC4B,EAuC5BA,aACAC,EAxC4B,EAwC5BA,cAGAvB,GA3C4B,EAyC5BlB,aAzC4B,EA0C5B0C,eA1C4B,EA2C5BxB,eA3C4B,EA4C5ByB,cAMF,OACE,oCACE,kBAAC/C,EAAoB4C,IACnB,0BAAWC,MACTxC,GAAgB,yGACjBA,GAAgB,4BAElBiB,EAAc0B,OAAS,GACtB,kBAAC,GAAD,CAAaC,SAAU3B,EAAc,GAAGE,KAAMN,KAAMA,MC9DrD,SAASgC,IACd,OACE,6BACE,wBAAIC,MAAO,CAAEC,SAAU,SAAvB,4BACA,wBAAID,MAAO,CAAEE,MAAO,OAAQC,WAAY,WAAxC,iECHC,IAAMC,EAAS,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SACvB,OAAO,kBAAC3D,EAAD,KAAgB2D,ICJzB,SAASC,IAA2Q,OAA9PA,EAAWC,OAAOC,QAAU,SAAU7B,GAAU,IAAK,IAAI8B,EAAI,EAAGA,EAAIC,UAAUb,OAAQY,IAAK,CAAE,IAAIE,EAASD,UAAUD,GAAI,IAAK,IAAIG,KAAOD,EAAcJ,OAAOM,UAAUC,eAAeC,KAAKJ,EAAQC,KAAQjC,EAAOiC,GAAOD,EAAOC,IAAY,OAAOjC,IAA2BqC,MAAMC,KAAMP,WAEhT,SAASQ,EAAyBP,EAAQQ,GAAY,GAAc,MAAVR,EAAgB,MAAO,GAAI,IAAkEC,EAAKH,EAAnE9B,EAEzF,SAAuCgC,EAAQQ,GAAY,GAAc,MAAVR,EAAgB,MAAO,GAAI,IAA2DC,EAAKH,EAA5D9B,EAAS,GAAQyC,EAAab,OAAOc,KAAKV,GAAqB,IAAKF,EAAI,EAAGA,EAAIW,EAAWvB,OAAQY,IAAOG,EAAMQ,EAAWX,GAAQU,EAASG,QAAQV,IAAQ,IAAajC,EAAOiC,GAAOD,EAAOC,IAAQ,OAAOjC,EAFxM4C,CAA8BZ,EAAQQ,GAAuB,GAAIZ,OAAOiB,sBAAuB,CAAE,IAAIC,EAAmBlB,OAAOiB,sBAAsBb,GAAS,IAAKF,EAAI,EAAGA,EAAIgB,EAAiB5B,OAAQY,IAAOG,EAAMa,EAAiBhB,GAAQU,EAASG,QAAQV,IAAQ,GAAkBL,OAAOM,UAAUa,qBAAqBX,KAAKJ,EAAQC,KAAgBjC,EAAOiC,GAAOD,EAAOC,IAAU,OAAOjC,EAMne,IAAIgD,EAAqB,IAAMC,cAAc,IAAK,MAE9CC,EAAqB,IAAMD,cAAc,IAAK,MAE9CE,EAAqB,IAAMF,cAAc,IAAK,MAE9CG,EAAqB,IAAMH,cAAc,IAAK,MAE9CI,EAAqB,IAAMJ,cAAc,IAAK,MAE9CK,EAAqB,IAAML,cAAc,IAAK,MAE9CM,EAAqB,IAAMN,cAAc,IAAK,MAE9CO,EAAqB,IAAMP,cAAc,IAAK,MAE9CQ,EAAsB,IAAMR,cAAc,IAAK,MAE/CS,EAAsB,IAAMT,cAAc,IAAK,MAE/CU,EAAsB,IAAMV,cAAc,IAAK,MAE/CW,EAAsB,IAAMX,cAAc,IAAK,MAE/CY,EAAsB,IAAMZ,cAAc,IAAK,MAE/Ca,EAAsB,IAAMb,cAAc,IAAK,MAE/Cc,GAAsB,IAAMd,cAAc,IAAK,MAE/C,GAAW,SAAkBe,GAC/B,IAAIC,EAASD,EAAKC,OACdC,EAAQF,EAAKE,MACb/F,EAAQoE,EAAyByB,EAAM,CAAC,SAAU,UAEtD,OAAoB,IAAMf,cAAc,MAAOtB,EAAS,CACtDwC,GAAI,SACJC,EAAG,MACHC,EAAG,MACHC,QAAS,cACTjD,MAAO,CACLkD,iBAAkB,mBAEpBC,SAAU,WACVC,IAAKR,GACJ9F,GAAQ+F,EAAqB,IAAMjB,cAAc,QAAS,KAAMiB,GAAS,KAAmB,IAAMjB,cAAc,OAAQ,CACzH5B,MAAO,CACLqD,KAAM,WAERC,EAAG,qJACY,IAAM1B,cAAc,IAAK,KAAmB,IAAMA,cAAc,OAAQ,CACvF5B,MAAO,CACLqD,KAAM,WAERC,EAAG,oHACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,oHACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,oHACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,oHACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,oHACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,oHACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,oHACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,qHACa,IAAM1B,cAAc,OAAQ,CAC5C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,kSACY,IAAM1B,cAAc,OAAQ,CAC3C5B,MAAO,CACLqD,KAAM,WAERC,EAAG,ufACD3B,EAAOE,EAAOC,EAAOC,EAAOC,EAAOC,EAAOC,EAAOC,EAAOC,EAAQC,EAAQC,EAAQC,EAAQC,EAAQC,EAAQC,KAG1Ga,GAA0B,IAAMC,YAAW,SAAU1G,EAAOsG,GAC9D,OAAoB,IAAMxB,cAAc,GAAUtB,EAAS,CACzDsC,OAAQQ,GACPtG,O,IAEU,I,yBC9FF2G,I,YAAc,SAAC,GAAwB,IAAtB3D,EAAqB,EAArBA,SAAU/B,EAAW,EAAXA,KAAW,EACnBD,qBADmB,mBAC1C4F,EAD0C,KACjCC,EADiC,OAErB7F,qBAFqB,mBAE1C8F,EAF0C,KAElCC,EAFkC,OAGnB/F,mBAAS,IAAIgG,MAHM,mBAG1CC,EAH0C,KAGjCC,EAHiC,OAInBlG,mBAAS,IAAIgG,MAJM,mBAI1CG,EAJ0C,KAIjCC,EAJiC,OAKPpG,qBALO,mBAK1CqG,EAL0C,KAK3BC,EAL2B,OAMTtG,qBANS,mBAM1CuG,EAN0C,KAM5BC,EAN4B,OAOTxG,mBAAS,IAPA,mBAO1CyG,EAP0C,KAO5BC,EAP4B,OAQT1G,mBAAS,IARA,mBAQ1C2G,EAR0C,KAQ5BC,EAR4B,OASf5G,mBAAS,CACzC,CACE6G,UAAW,IAAIb,KACfc,QAAS,KACThE,IAAK,eAbwC,mBAS1CiE,EAT0C,KAS/BC,EAT+B,OAgBjBhH,mBAAS,GAhBQ,mBAgB1CiH,GAhB0C,KAgBhCC,GAhBgC,QAiBXlH,mBAAS,GAjBE,qBAiB1CmH,GAjB0C,MAiB7BC,GAjB6B,MA4BjDC,qBAAU,WACR,GAAoB,qBAATpH,EAAsB,CAC/B,IAAIqH,EAAa,GACbC,EAAY,GACZC,EAAW,GACfvH,EAAKwH,KAAI,SAAAC,GACFJ,EAAWK,MAAK,SAAAC,GAAC,OAAIA,EAAEC,QAAUH,EAAK,0BACzCJ,EAAWQ,KAAK,CAAED,MAAOH,EAAK,sBAAQK,MAAOL,EAAK,wBAE/CH,EAAUI,MAAK,SAAAC,GAAC,OAAIA,EAAEC,QAAUH,EAAK,oBACxCH,EAAUO,KAAK,CAAED,MAAOH,EAAK,gBAAOK,MAAOL,EAAK,kBAE7CF,EAASQ,SAASN,EAAK,kBAC1BF,EAASM,KAAK,IAAI9B,KAAK0B,EAAK,qBAGhCH,EAAUU,QAAQ,CAChBJ,MAAO,eACPE,MAAO,iBAETT,EAAWW,QAAQ,CACjBJ,MAAO,eACPE,MAAO,iBAEThC,EAAUwB,GACV1B,EAAWyB,GACXpB,EAAW,IAAIF,KAAKkC,KAAKC,IAAIjF,MAAM,KAAMsE,KACzCpB,EAAW,IAAIJ,KAAKkC,KAAKE,IAAIlF,MAAM,KAAMsE,KACzCa,QAAQC,IAAIf,MAEb,CAACtH,IAuHJ,OACE,kBAACZ,EAAD,KACE,kBAACC,EAAD,KACE,kBAAC,GAAD,MACA,2BAAI0C,EAASuG,QAAQ,QAAS,MAEhC,kBAAChJ,EAAD,KACE,kBAACC,EAAD,KACE,6BACE,yBAAK0C,MAAO,CAAEsG,aAAc,SAC1B,4CACA,kBAAC,KAAD,CACEC,QAAS3C,EACT+B,MAAOtB,EACPmC,SAvKY,SAAAnC,GACxBC,EAAgBD,OAyKR,6BACE,4CACA,kBAAC,KAAD,CACEkC,QAAS7C,EACTiC,MAAOxB,EACPqC,SAnLa,SAAArC,GACzBC,EAAiBD,QAsLX,6BACE,kBAACvG,EAAD,KAAe2G,GACf,kBAAC9G,EAAD,CAAYgJ,QAjJL,WAKf,GAJAN,QAAQC,IAAI/B,GACZ8B,QAAQC,IAAIjC,GACZgC,QAAQC,IAAIvB,QAGO6B,IAAjBrC,QACkBqC,IAAlBvC,GAC8B,OAA9BU,EAAU,GAAV,WAC4B,OAA5BA,EAAU,GAAV,QACA,CACA,IAAI8B,EAAM,GAcV,YAbqBD,IAAjBrC,IACFsC,GAAO,yCAEaD,IAAlBvC,IACFwC,GAAO,oCAEyB,OAA9B9B,EAAU,GAAV,YACF8B,GAAO,gDAEuB,OAA5B9B,EAAU,GAAV,UACF8B,GAAO,qDAETnC,EAAgBmC,GAIlBnC,EAAgB,IAEhB,IAAIoC,EAAe7I,EAAK8I,QAAO,SAAArB,GAC7B,IAAIsB,EAAW,IAAIhD,KAAK0B,EAAK,iBAC7B,MAC4B,iBAA1BnB,EAAY,OACe,iBAA3BF,EAAa,QAIa,iBAA1BE,EAAY,OACe,iBAA3BF,EAAa,MAGXqB,EAAK,wBAAWrB,EAAa,OAC7B2C,GAAYjC,EAAU,GAAV,WACZiC,GAAYjC,EAAU,GAAV,QAMY,iBAA1BR,EAAY,OACe,iBAA3BF,EAAa,MAGXqB,EAAK,kBAAUnB,EAAY,OAC3ByC,GAAYjC,EAAU,GAAV,WACZiC,GAAYjC,EAAU,GAAV,QAOZW,EAAK,kBAAUnB,EAAY,OAC3BmB,EAAK,wBAAWrB,EAAa,OAC7B2C,GAAYjC,EAAU,GAAV,WACZiC,GAAYjC,EAAU,GAAV,YAQdkC,EAAM,EACNC,EAAS,EACbtC,EAAgBkC,GACZA,EAAa/G,OAAS,GACxB+G,EAAarB,KAAI,SAAAC,GACW,kBAAfA,EAAK,kBACduB,GAAOvB,EAAK,iBAEdwB,GAAUxB,EAAK,mBAGnBoB,EAAahB,KAAK,CAAEqB,qBAAK,eAAMC,eAAIH,EAAKI,eAAIH,IAE5ChC,GAAY+B,GACZ7B,GAAe8B,GAEfb,QAAQC,IAAIQ,IAuD2B1G,MAAO,QACnC,IADH,eAEK,OAIT,kBAAC3C,EAAD,KACE,wDACA,kBAAC,aAAD,CACE6J,oBAAoB,EACpBZ,SAAU,SAAAhB,GAAI,OAAIV,EAAa,CAACU,EAAK6B,aACrCC,2BAA2B,EAC3BC,OAAQ1C,EACRd,QAASA,EACTE,QAASA,EACTuD,YAAa,CAAC,eAIpB,kBAAChK,EAAD,KACE,6BACE,wDACA,2BAAiB,IAAbuH,GAAiBA,GAAW,uBAElC,6BACE,wDACA,2BAAoB,IAAhBE,GAAoBA,GAAc,uBAExC,kBAACtH,EAAD,CAAc8I,QAhFE,WACpB,GAAqB,KAAjBhC,EAAJ,CAIA,IAIM5F,EAAK,CAAEO,OAAQ,CAAErB,KADZe,QAAW2I,cAAchD,IACDvF,WAAY,CAAC,SAC1CwI,EAAc5I,QAAWD,EAAI,CAAE8I,SAAU,OAAQ5I,KAAM,UACvDhB,EAAO,IAAI6J,KAAK,CAACF,GAAc,CAAE3I,KALrC,oFAMIe,EAAW,eAAK+H,OACpB1D,EAAa,MACb,gBACAE,EAAY,MACZ,gBACAQ,EAAU,GAAV,UAA0BiD,mBAAmB,SAC7C,IACAjD,EAAU,GAAV,QAAwBiD,mBAAmB,UAE7CC,UAAiBhK,EAAM+B,EAdD,cALpBkI,MAAM,wBA8EJ,sCCnPOC,OATf,WACE,OACE,kBAAC,EAAD,KACE,kBAAClI,EAAD,MACA,kBAAC,EAAD,QCKcmI,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,GAAD,OAEFC,SAASC,eAAe,SDyHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBC,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLhD,QAAQgD,MAAMA,EAAMC,c","file":"static/js/main.df7a2530.chunk.js","sourcesContent":["import styled from \"styled-components\";\n\nexport const LayoutWrapper = styled.div`\n  @import url(\"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;400;700&display=swap\");\n  height: 100vh;\n  padding: 5rem 10rem;\n  font-family: \"Noto Sans SC\", sans-serif;\n`;\n\nexport const DropzoneWrapper = styled.div`\n  input {\n    width: 100%;\n    height: 100%;\n  }\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 3rem;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ${props => getColor(props)};\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  cursor: pointer;\n  transition: border 0.24s ease-in-out;\n`;\n\nconst getColor = props => {\n  if (props.isDragAccept) {\n    return \"#00e676\";\n  }\n  if (props.isDragReject) {\n    return \"#ff1744\";\n  }\n  if (props.isDragActive) {\n    return \"#2196f3\";\n  }\n  return \"#eeeeee\";\n};\n\nexport const FileProcessWrapper = styled.div`\n  padding: 3rem 0;\n`;\n\nexport const FilenameWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  height: 2.5rem;\n  padding: 2rem;\n  background: #fafafa;\n  align-items: center;\n  svg {\n    height: 100%;\n    width: 4rem;\n  }\n  p {\n    font-weight: bold;\n    font-size: 2rem;\n    color: #2e7d32;\n  }\n`;\n\nexport const FilterWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  background: #eef4ee;\n  height: 30rem;\n  justify-content: start;\n  color: #575757;\n  padding: 2rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n`;\n\nexport const FilterTextWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  margin-right: 5rem;\n  width: 20rem;\n`;\n\nexport const FilterDateWrapper = styled.div`\n  width: 25rem;\n`;\n\nexport const ResultWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  background: #dff2df;\n  justify-content: start;\n  color: #575757;\n  padding: 3rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n`;\n\nexport const CalcButton = styled.button`\n  padding: 0.6rem 1.5rem;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n`;\n\nexport const ExportButton = styled.button`\n  padding: 0.6rem 1.2rem;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n  margin-top: 1rem;\n`;\n\nexport const ErrorMessage = styled.div`\n  padding: 2rem 0rem;\n  font-weight: bolder;\n  color: #ed5757;\n`;\n","import React, { useCallback, useState } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { FileProcess } from \"../components\";\nimport { DropzoneWrapper } from \"../elements/StyledElements\";\nimport * as XLSX from \"xlsx\";\n\nexport const MyDropzone = () => {\n  const [data, setData] = useState();\n\n  const onDrop = useCallback(acceptedFiles => {\n    var f = acceptedFiles[0];\n    if (!f) {\n      return;\n    }\n    var name = f.name;\n    const reader = new FileReader();\n    reader.onload = evt => {\n      // evt = on_file_select event\n      /* Parse data */\n      const bstr = evt.target.result;\n      // var length = bstr.byteLength;\n      // var binary = \"\";\n      // for (var i = 0; i < length; i++) {\n      //   binary += String.fromCharCode(bstr[i]);\n      // }\n\n      const wb = XLSX.read(bstr, {\n        type: \"binary\",\n        cellDates: true\n      });\n      /* Get worksheets */\n      const wsnames = wb.SheetNames;\n\n      /* Convert to json */\n      const data = XLSX.utils.sheet_to_json(wb.Sheets[wsnames[0]], {\n        dateNF: \"mm/dd/yyyy;@\"\n      });\n      /* Update state */\n      setData(data);\n    };\n    reader.readAsBinaryString(f);\n  }, []);\n\n  const {\n    isDragActive,\n    getRootProps,\n    getInputProps,\n    isDragReject,\n    isDragAccepted,\n    acceptedFiles,\n    rejectedFiles\n  } = useDropzone({\n    onDrop,\n    accept: \".xlsx\"\n  });\n\n  return (\n    <>\n      <DropzoneWrapper {...getRootProps()}>\n        <input {...getInputProps()} />\n        {!isDragActive && \"点击这里或者拖拽文件至这里进行上传\"}\n        {isDragActive && \"放下文件\"}\n      </DropzoneWrapper>\n      {acceptedFiles.length > 0 && (\n        <FileProcess filename={acceptedFiles[0].name} data={data} />\n      )}\n    </>\n  );\n};\n","import React from \"react\";\n\nexport function Header() {\n  return (\n    <div>\n      <h1 style={{ fontSize: \"3rem\" }}>铺底统计</h1>\n      <h3 style={{ color: \"#000\", fontWeight: \"normal\" }}>\n        亲爱的王舟女士定制款\n      </h3>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { LayoutWrapper } from \"../elements/StyledElements\";\n\nexport const Layout = ({ children }) => {\n  return <LayoutWrapper>{children}</LayoutWrapper>;\n};\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref6 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref7 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref8 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref9 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref10 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref11 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref12 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref13 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref14 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref15 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref16 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar SvgExcel = function SvgExcel(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#ECEFF1\"\n    },\n    d: \"M496,432.011H272c-8.832,0-16-7.168-16-16s0-311.168,0-320s7.168-16,16-16h224 c8.832,0,16,7.168,16,16v320C512,424.843,504.832,432.011,496,432.011z\"\n  }), /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,176.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,176.011,336,176.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,240.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,240.011,336,240.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,304.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,304.011,336,304.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,368.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,368.011,336,368.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,176.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,176.011,432,176.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,240.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,240.011,432,240.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,304.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,304.011,432,304.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,368.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,368.011,432,368.011z\"\n  })), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#2E7D32\"\n    },\n    d: \"M282.208,19.691c-3.648-3.04-8.544-4.352-13.152-3.392l-256,48C5.472,65.707,0,72.299,0,80.011v352 c0,7.68,5.472,14.304,13.056,15.712l256,48c0.96,0.192,1.952,0.288,2.944,0.288c3.712,0,7.328-1.28,10.208-3.68 c3.68-3.04,5.792-7.584,5.792-12.32v-448C288,27.243,285.888,22.731,282.208,19.691z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#FAFAFA\"\n    },\n    d: \"M220.032,309.483l-50.592-57.824l51.168-65.792c5.44-6.976,4.16-17.024-2.784-22.464 c-6.944-5.44-16.992-4.16-22.464,2.784l-47.392,60.928l-39.936-45.632c-5.856-6.72-15.968-7.328-22.56-1.504 c-6.656,5.824-7.328,15.936-1.504,22.56l44,50.304L83.36,310.187c-5.44,6.976-4.16,17.024,2.784,22.464 c2.944,2.272,6.432,3.36,9.856,3.36c4.768,0,9.472-2.112,12.64-6.176l40.8-52.48l46.528,53.152 c3.168,3.648,7.584,5.504,12.032,5.504c3.744,0,7.488-1.312,10.528-3.968C225.184,326.219,225.856,316.107,220.032,309.483z\"\n  }), _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgExcel, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/excel.c59164de.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useState, useEffect } from \"react\";\nimport { ReactComponent as ExcelSvg } from \"../images/excel.svg\";\nimport { DateRange } from \"react-date-range\";\nimport {\n  FilterWrapper,\n  FilterTextWrapper,\n  ResultWrapper,\n  CalcButton,\n  ExportButton,\n  FilterDateWrapper,\n  ErrorMessage\n} from \"../elements/StyledElements\";\nimport Select from \"react-select\";\nimport {\n  FileProcessWrapper,\n  FilenameWrapper\n} from \"../elements/StyledElements\";\nimport * as FileSaver from \"file-saver\";\nimport * as XLSX from \"xlsx\";\nimport \"react-date-range/dist/styles.css\"; // main css file\nimport \"react-date-range/dist/theme/default.css\"; // theme css file\n\nexport const FileProcess = ({ filename, data }) => {\n  const [clients, setClients] = useState();\n  const [brands, setBrands] = useState();\n  const [minDate, setMinDate] = useState(new Date());\n  const [maxDate, setMaxDate] = useState(new Date());\n  const [currentClient, setCurrentClient] = useState();\n  const [currentBrand, setCurrentBrand] = useState();\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [filteredData, setFilteredData] = useState(\"\");\n  const [dateRange, setDateRange] = useState([\n    {\n      startDate: new Date(),\n      endDate: null,\n      key: \"selection\"\n    }\n  ]);\n  const [totalNum, setTotalNum] = useState(0);\n  const [totalAmount, setTotalAmount] = useState(0);\n  //   console.log(data);\n\n  const handleClientChange = currentClient => {\n    setCurrentClient(currentClient);\n  };\n\n  const handleBrandChange = currentBrand => {\n    setCurrentBrand(currentBrand);\n  };\n\n  useEffect(() => {\n    if (typeof data !== \"undefined\") {\n      let clientlist = [];\n      let brandlist = [];\n      let datelist = [];\n      data.map(item => {\n        if (!clientlist.some(e => e.value === item[\"客户名\"])) {\n          clientlist.push({ value: item[\"客户名\"], label: item[\"客户名\"] });\n        }\n        if (!brandlist.some(e => e.value === item[\"品牌\"])) {\n          brandlist.push({ value: item[\"品牌\"], label: item[\"品牌\"] });\n        }\n        if (!datelist.includes(item[\"日期\"])) {\n          datelist.push(new Date(item[\"日期\"]));\n        }\n      });\n      brandlist.unshift({\n        value: \"全选\",\n        label: \"全选\"\n      });\n      clientlist.unshift({\n        value: \"全选\",\n        label: \"全选\"\n      });\n      setBrands(brandlist);\n      setClients(clientlist);\n      setMinDate(new Date(Math.min.apply(null, datelist)));\n      setMaxDate(new Date(Math.max.apply(null, datelist)));\n      console.log(brandlist);\n    }\n  }, [data]);\n\n  const calcFunc = () => {\n    console.log(currentBrand);\n    console.log(currentClient);\n    console.log(dateRange);\n\n    if (\n      currentBrand === undefined ||\n      currentClient === undefined ||\n      dateRange[0][\"startDate\"] === null ||\n      dateRange[0][\"endDate\"] === null\n    ) {\n      let msg = \"\";\n      if (currentBrand === undefined) {\n        msg += \"请选择品牌; \";\n      }\n      if (currentClient === undefined) {\n        msg += \"请选择客户; \";\n      }\n      if (dateRange[0][\"startDate\"] === null) {\n        msg += \"请设定开始时间; \";\n      }\n      if (dateRange[0][\"endDate\"] === null) {\n        msg += \"请设定结束时间; \";\n      }\n      setErrorMessage(msg);\n      return;\n    }\n\n    setErrorMessage(\"\");\n\n    let filteredDate = data.filter(item => {\n      let itemdate = new Date(item[\"日期\"]);\n      if (\n        currentBrand[\"value\"] === \"全选\" &&\n        currentClient[\"value\"] === \"全选\"\n      ) {\n        return true;\n      } else if (\n        currentBrand[\"value\"] === \"全选\" &&\n        currentClient[\"value\"] !== \"全选\"\n      ) {\n        if (\n          item[\"客户名\"] === currentClient[\"value\"] &&\n          itemdate >= dateRange[0][\"startDate\"] &&\n          itemdate <= dateRange[0][\"endDate\"]\n        ) {\n          return true;\n        }\n        return false;\n      } else if (\n        currentBrand[\"value\"] !== \"全选\" &&\n        currentClient[\"value\"] === \"全选\"\n      ) {\n        if (\n          item[\"品牌\"] === currentBrand[\"value\"] &&\n          itemdate >= dateRange[0][\"startDate\"] &&\n          itemdate <= dateRange[0][\"endDate\"]\n        ) {\n          return true;\n        }\n        return false;\n      } else {\n        if (\n          item[\"品牌\"] === currentBrand[\"value\"] &&\n          item[\"客户名\"] === currentClient[\"value\"] &&\n          itemdate >= dateRange[0][\"startDate\"] &&\n          itemdate <= dateRange[0][\"endDate\"]\n        ) {\n          return true;\n        }\n        return false;\n      }\n    });\n\n    let num = 0;\n    let amount = 0;\n    setFilteredData(filteredDate);\n    if (filteredDate.length > 0) {\n      filteredDate.map(item => {\n        if (typeof item[\"数量\"] === \"number\") {\n          num += item[\"数量\"];\n        }\n        amount += item[\"金额\"];\n      });\n    }\n    filteredDate.push({ 客户名: \"累计\", 数量: num, 金额: amount });\n\n    setTotalNum(num);\n    setTotalAmount(amount);\n\n    console.log(filteredDate);\n  };\n\n  const exportToExcel = () => {\n    if (filteredData === \"\") {\n      alert(\"无数据\");\n      return;\n    }\n    const fileType =\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n    const fileExtension = \".xlsx\";\n    const ws = XLSX.utils.json_to_sheet(filteredData);\n    const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n    const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n    const data = new Blob([excelBuffer], { type: fileType });\n    const filename = \"客户\".concat(\n      currentClient[\"value\"],\n      \"_品牌\",\n      currentBrand[\"value\"],\n      \"_时间\",\n      dateRange[0][\"startDate\"].toLocaleDateString(\"zh-CN\"),\n      \"-\",\n      dateRange[0][\"endDate\"].toLocaleDateString(\"zh-CN\")\n    );\n    FileSaver.saveAs(data, filename + fileExtension);\n  };\n\n  return (\n    <FileProcessWrapper>\n      <FilenameWrapper>\n        <ExcelSvg />\n        <p>{filename.replace(\".xlsx\", \"\")}</p>\n      </FilenameWrapper>\n      <FilterWrapper>\n        <FilterTextWrapper>\n          <div>\n            <div style={{ marginBottom: \"3rem\" }}>\n              <h2>品牌</h2>\n              <Select\n                options={brands}\n                value={currentBrand}\n                onChange={handleBrandChange}\n              />\n            </div>\n            <div>\n              <h2>客户</h2>\n              <Select\n                options={clients}\n                value={currentClient}\n                onChange={handleClientChange}\n              />\n            </div>\n          </div>\n          <div>\n            <ErrorMessage>{errorMessage}</ErrorMessage>\n            <CalcButton onClick={calcFunc} color={\"calc\"}>\n              {\" \"}\n              计算{\" \"}\n            </CalcButton>\n          </div>\n        </FilterTextWrapper>\n        <FilterDateWrapper>\n          <h2>时间区间</h2>\n          <DateRange\n            editableDateInputs={true}\n            onChange={item => setDateRange([item.selection])}\n            moveRangeOnFirstSelection={false}\n            ranges={dateRange}\n            minDate={minDate}\n            maxDate={maxDate}\n            rangeColors={[\"#61988e\"]}\n          />\n        </FilterDateWrapper>\n      </FilterWrapper>\n      <ResultWrapper>\n        <div>\n          <h2>累计数量</h2>\n          <p>{totalNum !== 0 ? totalNum : \"无数据\"}</p>\n        </div>\n        <div>\n          <h2>累计金额</h2>\n          <p>{totalAmount !== 0 ? totalAmount : \"无数据\"}</p>\n        </div>\n        <ExportButton onClick={exportToExcel}> 导出excel文件</ExportButton>\n      </ResultWrapper>\n    </FileProcessWrapper>\n  );\n};\n","import React from \"react\";\nimport { Header, Layout, MyDropzone } from \"./components\";\n\nfunction App() {\n  return (\n    <Layout>\n      <Header />\n      <MyDropzone />\n    </Layout>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}