(this["webpackJsonpexcel-process"]=this["webpackJsonpexcel-process"]||[]).push([[0],{100:function(e,t){},158:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(17),c=n.n(r),o=(n(91),n(10)),u=n(37),i=n(5),s=n(11),m=n(4),f=n(23),d=n(49);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var h=l.a.createElement("g",null),E=l.a.createElement("g",null),b=l.a.createElement("g",null),g=l.a.createElement("g",null),j=l.a.createElement("g",null),O=l.a.createElement("g",null),y=l.a.createElement("g",null),x=l.a.createElement("g",null),S=l.a.createElement("g",null),w=l.a.createElement("g",null),D=l.a.createElement("g",null),F=l.a.createElement("g",null),C=l.a.createElement("g",null),M=l.a.createElement("g",null),k=l.a.createElement("g",null),_=function(e){var t=e.svgRef,n=e.title,a=p(e,["svgRef","title"]);return l.a.createElement("svg",v({id:"Capa_1",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",ref:t},a),n?l.a.createElement("title",null,n):null,l.a.createElement("path",{style:{fill:"#ECEFF1"},d:"M496,432.011H272c-8.832,0-16-7.168-16-16s0-311.168,0-320s7.168-16,16-16h224 c8.832,0,16,7.168,16,16v320C512,424.843,504.832,432.011,496,432.011z"}),l.a.createElement("g",null,l.a.createElement("path",{style:{fill:"#388E3C"},d:"M336,176.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,176.011,336,176.011z"}),l.a.createElement("path",{style:{fill:"#388E3C"},d:"M336,240.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,240.011,336,240.011z"}),l.a.createElement("path",{style:{fill:"#388E3C"},d:"M336,304.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,304.011,336,304.011z"}),l.a.createElement("path",{style:{fill:"#388E3C"},d:"M336,368.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,368.011,336,368.011z"}),l.a.createElement("path",{style:{fill:"#388E3C"},d:"M432,176.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,176.011,432,176.011z"}),l.a.createElement("path",{style:{fill:"#388E3C"},d:"M432,240.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,240.011,432,240.011z"}),l.a.createElement("path",{style:{fill:"#388E3C"},d:"M432,304.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,304.011,432,304.011z"}),l.a.createElement("path",{style:{fill:"#388E3C"},d:"M432,368.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,368.011,432,368.011z"})),l.a.createElement("path",{style:{fill:"#2E7D32"},d:"M282.208,19.691c-3.648-3.04-8.544-4.352-13.152-3.392l-256,48C5.472,65.707,0,72.299,0,80.011v352 c0,7.68,5.472,14.304,13.056,15.712l256,48c0.96,0.192,1.952,0.288,2.944,0.288c3.712,0,7.328-1.28,10.208-3.68 c3.68-3.04,5.792-7.584,5.792-12.32v-448C288,27.243,285.888,22.731,282.208,19.691z"}),l.a.createElement("path",{style:{fill:"#FAFAFA"},d:"M220.032,309.483l-50.592-57.824l51.168-65.792c5.44-6.976,4.16-17.024-2.784-22.464 c-6.944-5.44-16.992-4.16-22.464,2.784l-47.392,60.928l-39.936-45.632c-5.856-6.72-15.968-7.328-22.56-1.504 c-6.656,5.824-7.328,15.936-1.504,22.56l44,50.304L83.36,310.187c-5.44,6.976-4.16,17.024,2.784,22.464 c2.944,2.272,6.432,3.36,9.856,3.36c4.768,0,9.472-2.112,12.64-6.176l40.8-52.48l46.528,53.152 c3.168,3.648,7.584,5.504,12.032,5.504c3.744,0,7.488-1.312,10.528-3.968C225.184,326.219,225.856,316.107,220.032,309.483z"}),h,E,b,g,j,O,y,x,S,w,D,F,C,M,k)},z=l.a.forwardRef((function(e,t){return l.a.createElement(_,v({svgRef:t},e))})),A=(n.p,n(32)),N=n.n(A),B=n(47);n(66),n(67);function P(){var e=Object(o.a)(["\n  border-collapse: collapse;\n  width: 100%;\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);\n\n  td,\n  th {\n    border: 2px solid #eef4ee;\n    text-align: left;\n    padding: 1.5rem;\n  }\n\n  th {\n    font-size: 1.5rem;\n  }\n\n  tr {\n    background-color: #fff;\n  }\n  tr:nth-child(even) {\n    background-color: #eef4ee;\n  }\n"]);return P=function(){return e},e}function R(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  h2 {\n    font-size: 1.75rem;\n  }\n  h3 {\n    font-weight: normal;\n  }\n\n  span {\n    margin-right: 3rem;\n  }\n"]);return R=function(){return e},e}function Y(){var e=Object(o.a)(["\n  padding: 2rem 0rem;\n  font-weight: bolder;\n  color: #ed5757;\n"]);return Y=function(){return e},e}function T(){var e=Object(o.a)(["\n  padding: 0.6rem 1.2rem;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n  margin-top: 1rem;\n"]);return T=function(){return e},e}function I(){var e=Object(o.a)(["\n  padding: 0.6rem 1.5rem;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n"]);return I=function(){return e},e}function L(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  background: #dff2df;\n  justify-content: start;\n  color: #575757;\n  padding: 3rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n"]);return L=function(){return e},e}function U(){var e=Object(o.a)(['\n  font-family: "Noto Sans SC", sans-serif;\n  padding: 0.5rem 1.5rem;\n  font-size: 1rem;\n  border: none;\n  background: #61988e;\n  color: white;\n  cursor: pointer;\n  transition: all 0.5s;\n  &:active,\n  :focus,\n  :hover {\n    background: #2f5f56;\n  }\n']);return U=function(){return e},e}function W(){var e=Object(o.a)(["\n  width: 25rem;\n"]);return W=function(){return e},e}function J(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  margin-right: 5rem;\n  width: 20rem;\n"]);return J=function(){return e},e}function H(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: row;\n  background: #eef4ee;\n  height: 23rem;\n  justify-content: start;\n  color: #575757;\n  padding: 2rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n"]);return H=function(){return e},e}function $(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: row;\n  height: 2.5rem;\n  padding: 2rem;\n  background: #fafafa;\n  align-items: center;\n  svg {\n    height: 100%;\n    width: 4rem;\n  }\n  p {\n    font-weight: bold;\n    font-size: 2rem;\n    color: #2e7d32;\n  }\n"]);return $=function(){return e},e}function q(){var e=Object(o.a)(["\n  padding: 3rem 0;\n"]);return q=function(){return e},e}function G(){var e=Object(o.a)(["\n  input {\n    width: 100%;\n    height: 100%;\n  }\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 3rem;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ",";\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  cursor: pointer;\n  transition: border 0.24s ease-in-out;\n"]);return G=function(){return e},e}function K(){var e=Object(o.a)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n"]);return K=function(){return e},e}function Q(){var e=Object(o.a)(["\n  height: 3rem;\n  width: 5rem;\n  padding: 1rem 2rem;\n  border-width: 2px;\n  border-radius: 2px;\n  background-color: ",';\n  border-color: "#61988e";\n  color: ',";\n"]);return Q=function(){return e},e}function V(){var e=Object(o.a)(['\n  @import url("https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;400;700&display=swap");\n  height: 100vh;\n  padding: 5rem 10rem;\n  font-family: "Noto Sans SC", sans-serif;\n']);return V=function(){return e},e}var X=s.a.div(V()),Z=(s.a.div(Q(),(function(e){return e.active?"#61988e":"#fff"}),(function(e){return e.active?"#fff":"#61988e"})),s.a.div(K()),s.a.div(G(),(function(e){return ee(e)}))),ee=function(e){return e.isDragAccept?"#00e676":e.isDragReject?"#ff1744":e.isDragActive?"#2196f3":"#eeeeee"},te=s.a.div(q()),ne=s.a.div($()),ae=s.a.div(H()),le=s.a.div(J()),re=s.a.div(W()),ce=s.a.button(U()),oe=s.a.div(L()),ue=s.a.button(I()),ie=s.a.button(T()),se=s.a.div(Y()),me=s.a.div(R()),fe=s.a.table(P()),de=n(27),ve=n(29),pe=n(9),he=(n(71),n(72),function(e){var t=e.filteredData,n=e.client,r=e.sale,c=e.month,o=Object(a.useState)([]),u=Object(m.a)(o,2),i=u[0],s=u[1],f=Object(a.useState)(),d=Object(m.a)(f,2),v=d[0],p=d[1];return Object(a.useEffect)((function(){if("undefined"!==typeof t){var e=[];t.map((function(t){if(e.some((function(e){return e["\u54c1\u79cd"]===t["\u54c1\u79cd"]&&e["\u5355\u4ef7"]===t["\u5355\u4ef7"]}))||"\u7d2f\u8ba1"===t["\u5ba2\u6237\u540d"]){if("\u7d2f\u8ba1"!==t["\u5ba2\u6237\u540d"]){var n=e.findIndex((function(e){return e["\u54c1\u79cd"]===t["\u54c1\u79cd"]&&e["\u5355\u4ef7"]===t["\u5355\u4ef7"]})),a=e[n];a["\u6570\u91cf"]+=t["\u6570\u91cf"],a["\u91d1\u989d"]+=t["\u91d1\u989d"],e[n]=a}}else{var l={"\u54c1\u724c":t["\u54c1\u724c"],"\u54c1\u79cd":t["\u54c1\u79cd"],"\u5355\u4ef7":t["\u5355\u4ef7"],"\u6570\u91cf":t["\u6570\u91cf"],"\u91d1\u989d":t["\u91d1\u989d"]};e.push(l)}}));var n=t.find((function(e){return"\u7d2f\u8ba1"===e["\u5ba2\u6237\u540d"]}));p(n),e.sort((function(e,t){return 1===e["\u54c1\u724c"].localeCompare(t["\u54c1\u724c"],"zh")?1:-1===e["\u54c1\u724c"].localeCompare(t["\u54c1\u724c"],"zh")?-1:e["\u54c1\u79cd"].localeCompare(t["\u54c1\u79cd"],"zh")})),s(e)}}),[t]),l.a.createElement("div",null,function(){if(void 0!==n&&void 0!==r&&void 0!==t&&void 0!==v)return 0===t.length?l.a.createElement("p",null,"\u65e0\u6570\u636e"):l.a.createElement(l.a.Fragment,null,l.a.createElement(me,null,l.a.createElement("h2",null,"\u7ed3\u679c"),l.a.createElement("h3",null,l.a.createElement("span",null,"\u4e1a\u52a1\u5458\uff1a",r),l.a.createElement("span",null,"\u5ba2\u6237\uff1a",n),l.a.createElement("span",null,"\u622a\u6b62\u81f3: ",c.getFullYear(),"\u5e74",c.getMonth()+1,"\u6708"),l.a.createElement("span",null,"\u7d2f\u8ba1\u6570\u91cf\uff1a",v["\u6570\u91cf"]),l.a.createElement("span",null,"\u7d2f\u8ba1\u91d1\u989d\uff1a",v["\u91d1\u989d"].toFixed(2)))),l.a.createElement(fe,null,l.a.createElement("tr",null,l.a.createElement("th",null,"\u54c1\u724c"),l.a.createElement("th",null,"\u54c1\u79cd"),l.a.createElement("th",null,"\u5355\u4ef7"),l.a.createElement("th",null,"\u6570\u91cf"),l.a.createElement("th",null,"\u91d1\u989d")),i.map((function(e){if(0!==e["\u6570\u91cf"])return l.a.createElement("tr",null,l.a.createElement("td",null,e["\u54c1\u724c"]),l.a.createElement("td",null,e["\u54c1\u79cd"]),l.a.createElement("td",null,e["\u5355\u4ef7"]),l.a.createElement("td",null,e["\u6570\u91cf"]),l.a.createElement("td",null,e["\u91d1\u989d"].toFixed(2)))}))))}())}),Ee=function(e){var t=e.filename,n=e.data,r=Object(a.useState)(),c=Object(m.a)(r,2),o=c[0],u=c[1],i=Object(a.useState)(),s=Object(m.a)(i,2),f=s[0],v=s[1],p=Object(a.useState)(new Date),h=Object(m.a)(p,2),E=h[0],b=h[1],g=Object(a.useState)(new Date),j=Object(m.a)(g,2),O=j[0],y=j[1],x=Object(a.useState)({value:"",label:""}),S=Object(m.a)(x,2),w=S[0],D=S[1],F=Object(a.useState)({value:"",label:""}),C=Object(m.a)(F,2),M=C[0],k=C[1],_=Object(a.useState)(),P=Object(m.a)(_,2),R=P[0],Y=P[1],T=Object(a.useState)({value:"\u5168\u9009",label:"\u5168\u9009"}),I=Object(m.a)(T,2),L=I[0],U=I[1],W=Object(a.useState)({value:"\u5168\u9009",label:"\u5168\u9009"}),J=Object(m.a)(W,2),H=J[0],$=J[1],q=Object(a.useState)(""),G=Object(m.a)(q,2),K=G[0],Q=G[1],V=Object(a.useState)(),X=Object(m.a)(V,2),Z=X[0],ee=X[1],me=Object(a.useState)(),fe=Object(m.a)(me,2),Ee=fe[0],be=fe[1],ge=Object(a.useState)(new Date),je=Object(m.a)(ge,2),Oe=je[0],ye=je[1];Object(A.registerLocale)("zhCN",B.a);var xe=Object(a.useState)(0),Se=Object(m.a)(xe,2),we=(Se[0],Se[1],Object(a.useState)(0)),De=Object(m.a)(we,2),Fe=(De[0],De[1],function(e){var t=e.value,n=e.onClick;return l.a.createElement(ce,{onClick:n},t)});Object(a.useEffect)((function(){if("undefined"!==typeof n){var e=[],t=[],a=[];n.map((function(n){e.some((function(e){return e.value===n["\u5ba2\u6237\u540d"]}))||e.push({value:n["\u5ba2\u6237\u540d"],label:n["\u5ba2\u6237\u540d"]}),t.some((function(e){return e.value===n["\u4e1a\u52a1\u5458"]}))||t.push({value:n["\u4e1a\u52a1\u5458"],label:n["\u4e1a\u52a1\u5458"]}),a.includes(n["\u65e5\u671f"])||a.push(new Date(n["\u65e5\u671f"]))})),e.unshift({value:"\u5168\u9009",label:"\u5168\u9009"}),t.unshift({value:"\u5168\u9009",label:"\u5168\u9009"}),v(t),u(e),b(new Date(Math.min.apply(null,a))),y(new Date(Math.max.apply(null,a))),ye(new Date(Math.min.apply(null,a)))}}),[n]);return l.a.createElement(te,null,l.a.createElement(ne,null,l.a.createElement(z,null),l.a.createElement("p",null,t.replace(".xlsx",""))),l.a.createElement(ae,null,l.a.createElement(le,null,l.a.createElement("div",null,l.a.createElement("div",{style:{marginBottom:"3rem"}},l.a.createElement("h2",null,"\u4e1a\u52a1\u5458"),l.a.createElement(de.a,{options:f,value:H,onChange:function(e){$(e)}})),l.a.createElement("div",null,l.a.createElement("h2",null,"\u5ba2\u6237"),l.a.createElement(de.a,{options:o,value:L,onChange:function(e){U(e)}}))),l.a.createElement("div",null,l.a.createElement(se,null,K),l.a.createElement(ue,{onClick:function(){if(void 0===H||""===H.value||void 0===L||""===L.value){var e="";return void 0!==H&&""!==H.value||(e+="\u8bf7\u9009\u62e9\u4e1a\u52a1\u5458; "),void 0!==L&&""!==L.value||(e+="\u8bf7\u9009\u62e9\u5ba2\u6237; "),void Q(e)}Q("");var t=new Date(Oe.getFullYear(),Oe.getMonth(),1);t.setMonth(t.getMonth()+1),console.log(t);var a=n.filter((function(e){return e["\u65e5\u671f"]<t?"\u5168\u9009"===H.value&&"\u5168\u9009"===L.value||("\u5168\u9009"===H.value&&"\u5168\u9009"!==L.value?e["\u5ba2\u6237\u540d"]===L.value:"\u5168\u9009"!==H.value&&"\u5168\u9009"===L.value?e["\u4e1a\u52a1\u5458"]===H.value:e["\u4e1a\u52a1\u5458"]===H.value&&e["\u5ba2\u6237\u540d"]===L.value):(console.log(e["\u65e5\u671f"]+"not in time"),!1)})),l=0,r=0,c=[];a.length>0&&a.map((function(e){"number"===typeof e["\u6570\u91cf"]&&(l+=e["\u6570\u91cf"]),r+=Number.parseFloat(e["\u91d1\u989d"]);var t=Object(d.a)({},e);c.push(t)})),a.push({"\u5ba2\u6237\u540d":"\u7d2f\u8ba1","\u6570\u91cf":l,"\u91d1\u989d":r}),c.push({"\u5ba2\u6237\u540d":"\u7d2f\u8ba1","\u6570\u91cf":l,"\u91d1\u989d":r}),c.length>0&&c.map((function(e){if("\u7d2f\u8ba1"!==e["\u5ba2\u6237\u540d"]){var t=e["\u65e5\u671f"].getFullYear(),n=e["\u65e5\u671f"].getMonth()+1;e["\u65e5\u671f"]=t+"\u5e74"+n+"\u6708"}})),be(c),ee(a),D(L),k(H),Y(Oe)},color:"calc"}," ","\u8ba1\u7b97"," "))),l.a.createElement(re,null,l.a.createElement("h2",null,"\u9009\u62e9\u622a\u6b62\u6708\u4efd"),l.a.createElement(N.a,{selected:Oe,onChange:function(e){ye(e)},dateFormat:"MM/yyyy",showMonthYearPicker:!0,maxDate:O,minDate:E,locale:"zhCN",customInput:l.a.createElement(Fe,null)}))),l.a.createElement(oe,null,l.a.createElement(he,{filteredData:Z,client:w.value,sale:M.value,month:R}),l.a.createElement(ie,{onClick:function(){if(""!==Ee){var e={Sheets:{data:pe.utils.json_to_sheet(Ee)},SheetNames:["data"]},t=pe.write(e,{bookType:"xlsx",type:"array"}),n=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),a="\u5ba2\u6237".concat(L.value,"_\u4e1a\u52a1\u5458",H.value);ve.saveAs(n,a+".xlsx")}else alert("\u65e0\u6570\u636e")}}," \u5bfc\u51faexcel\u6587\u4ef6")))},be=function(){var e=Object(a.useState)(),t=Object(m.a)(e,2),n=t[0],r=t[1],c=Object(a.useCallback)((function(e){var t=e[0];if(t){t.name;var n=new FileReader;n.onload=function(e){var t=e.target.result,n=pe.read(t,{type:"binary",cellDates:!0}),a=n.SheetNames,l=pe.utils.sheet_to_json(n.Sheets[a[0]],{dateNF:"mm/dd/yyyy;@"});r(l)},n.readAsBinaryString(t)}}),[]),o=Object(f.a)({onDrop:c,accept:".xlsx"}),u=o.isDragActive,i=o.getRootProps,s=o.getInputProps,d=(o.isDragReject,o.isDragAccepted,o.acceptedFiles);o.rejectedFiles;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h1",null,"\u94fa\u5e95\u7edf\u8ba1"),l.a.createElement(Z,i(),l.a.createElement("input",s()),!u&&"\u70b9\u51fb\u8fd9\u91cc\u6216\u8005\u62d6\u62fd\u6587\u4ef6\u81f3\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20",u&&"\u653e\u4e0b\u6587\u4ef6"),d.length>0&&l.a.createElement(Ee,{filename:d[0].name,data:n}))};function ge(){return l.a.createElement("div",null,l.a.createElement("h1",{style:{fontSize:"3rem"}},"\u4f1a\u8ba1\u5c0f\u52a9\u624b"),l.a.createElement("h3",{style:{color:"#000",fontWeight:"normal"}},"\u4eb2\u7231\u7684\u738b\u821f\u5973\u58eb\u5b9a\u5236\u6b3e"))}var je=function(e){var t=e.children;return l.a.createElement(X,null,t)},Oe=function(e){var t=Object(a.useState)(),n=Object(m.a)(t,2),r=(n[0],n[1]),c=Object(a.useState)(),o=Object(m.a)(c,2),u=(o[0],o[1]),i=Object(a.useCallback)((function(t){var n=t[0];if(n){n.name;var a=new FileReader;a.onload=function(t){var n=t.target.result,a=pe.read(n,{type:"binary",cellDates:!0}),l=a.SheetNames,c=a.Sheets[l[0]];r(c);var o=pe.utils.sheet_to_json(a.Sheets[l[1]],{dateNF:"mm/dd/yyyy;@"});u(o),e.onDropFile(c,o)},a.readAsBinaryString(n)}}),[]),s=Object(f.a)({onDrop:i,accept:".xlsx, .xls"}),d=s.isDragActive,v=s.getRootProps,p=s.getInputProps;s.isDragReject,s.isDragAccepted,s.acceptedFiles,s.rejectedFiles;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",null,"\u5bf9\u8d26\u5355"),l.a.createElement(Z,v(),l.a.createElement("input",p()),!d&&"\u70b9\u51fb\u8fd9\u91cc\u6216\u8005\u62d6\u62fd\u6587\u4ef6\u81f3\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20",d&&"\u653e\u4e0b\u6587\u4ef6"))},ye=function(e){var t=Object(a.useState)(),n=Object(m.a)(t,2),r=(n[0],n[1]),c=Object(a.useCallback)((function(t){var n=t[0];if(n){n.name;var a=new FileReader;a.onload=function(t){var n=t.target.result,a=pe.read(n,{type:"binary",cellDates:!0}),l=a.SheetNames,c=pe.utils.sheet_to_json(a.Sheets[l[0]],{dateNF:"mm/dd/yyyy;@"});r(c),e.onDropFile(c)},a.readAsBinaryString(n)}}),[]),o=Object(f.a)({onDrop:c,accept:".xlsx, .xls"}),u=o.isDragActive,i=o.getRootProps,s=o.getInputProps;o.isDragReject,o.isDragAccepted,o.acceptedFiles,o.rejectedFiles;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",null,"\u4ea7\u54c1\u4ee3\u66ff"),l.a.createElement(Z,i(),l.a.createElement("input",s()),!u&&"\u70b9\u51fb\u8fd9\u91cc\u6216\u8005\u62d6\u62fd\u6587\u4ef6\u81f3\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20",u&&"\u653e\u4e0b\u6587\u4ef6"))},xe=function(e){var t=e.sumData,n=e.detailData,r=e.replaceData,c=Object(a.useState)(),o=Object(m.a)(c,2),u=o[0],i=o[1];Object(a.useEffect)((function(){var e={};r.map((function(t){e[t["\u4ea7\u54c1\u540d\u79f0"]]=t["\u66ff\u4ee3\u54c1\u79cd"]})),i(e)}),[r]);var s=function(e){return e.map((function(e){if(e.__EMPTY_4&&"\u54c1\u79cd"!==e.__EMPTY_4){var t=Object(d.a)({},e);return t.__EMPTY_4 in u?(t.__EMPTY_4=u[t.__EMPTY_4],t):e}return e}))};return l.a.createElement("div",{style:{marginBottom:100}},l.a.createElement(ie,{onClick:function(){if(""!==t){for(var e=16,a=t["B".concat(e)],l=[],r={c:2,r:e-1},c={c:2,r:e-1},o={c:3,r:e-1},u={c:3,r:e-1},i={c:4,r:e-1},m={c:4,r:e-1},f={c:5,r:e-1},d={c:5,r:e-1};;){e++;var v=t["B".concat(e)];if("\u5408\u8ba1"===v.v)break;if(v.v===a.v){c={c:2,r:e-1},u={c:3,r:e-1};var p=parseFloat(t["D".concat(e)].v)+parseFloat(t["D".concat(e-1)].v);t["D".concat(e)].v=p.toString(),t["D".concat(e-1)].v=p.toString(),m={c:4,r:e-1},p=parseFloat(t["E".concat(e)].v)+parseFloat(t["E".concat(e-1)].v),t["E".concat(e)].v=p.toString(),t["E".concat(e-1)].v=p.toString(),d={c:5,r:e-1},t["F".concat(e-1)].v=t["F".concat(e)].v}else c!==r&&(l.push({s:r,e:c}),l.push({s:o,e:u}),l.push({s:i,e:m}),l.push({s:f,e:d})),r={c:2,r:e-1},c={c:2,r:e-1},o={c:3,r:e-1},u={c:3,r:e-1},i={c:4,r:e-1},m={c:4,r:e-1},f={c:5,r:e-1},d={c:5,r:e-1};a=t["B".concat(e)]}var h=s(n);t["!merges"]=t["!merges"].concat(l);var E={Sheets:{sum:t,detail:pe.utils.json_to_sheet(h)},SheetNames:["sum","detail"]},b=pe.write(E,{bookType:"xlsx",type:"array"}),g=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});ve.saveAs(g,"test.xlsx")}else alert("\u65e0\u6570\u636e")}},"\u5bfc\u51fa"))},Se=function(){var e=Object(a.useState)(),t=Object(m.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(),o=Object(m.a)(c,2),u=o[0],i=o[1],s=Object(a.useState)(),f=Object(m.a)(s,2),d=f[0],v=f[1];return console.log("sumData",n),console.log("replaceData",d),l.a.createElement("div",null,l.a.createElement("h1",null,"\u5bf9\u8d26\u6574\u5408"),l.a.createElement(Oe,{onDropFile:function(e,t){r(e),i(t)}}),l.a.createElement(ye,{onDropFile:function(e){v(e)}}),void 0===d?l.a.createElement("div",null,l.a.createElement("p",null)):l.a.createElement(xe,{sumData:n,detailData:u,replaceData:d}))},we=n(85),De=function(e){var t=e.printData,n=e.client,a=e.sale,r=e.month;e.recycleMonth;return l.a.createElement("div",null,function(){if(void 0!==n&&void 0!==a&&void 0!==t)return 0===t.length?l.a.createElement("p",null,"\u65e0\u6570\u636e"):l.a.createElement(l.a.Fragment,null,l.a.createElement(me,null,l.a.createElement("h2",null,"\u7ed3\u679c"),l.a.createElement("h3",null,l.a.createElement("span",null,"\u4e1a\u52a1\u5458\uff1a",a),l.a.createElement("span",null,"\u5ba2\u6237\uff1a",n),l.a.createElement("span",null,"\u622a\u6b62\u81f3: ",r.getFullYear(),"\u5e74",r.getMonth()+1,"\u6708"))),l.a.createElement(fe,null,l.a.createElement("tr",null,l.a.createElement("th",null,"\u4e1a\u52a1\u5458"),l.a.createElement("th",null,"\u5ba2\u6237\u540d\u79f0"),l.a.createElement("th",null,"\u672a\u56de\u6536\u671f\u6570")),t.map((function(e){if(0!==e["\u6570\u91cf"])return l.a.createElement("tr",null,l.a.createElement("td",null,e["\u4e1a\u52a1\u5458"]),l.a.createElement("td",null,e["\u5ba2\u6237\u540d\u79f0"]),l.a.createElement("td",null,e["\u672a\u56de\u6536\u671f\u6570"]))}))))}())},Fe=Object(we.a)(Array(12).keys()).map((function(e){return 11===e?{value:12,label:"1\u5e74\u4ee5\u4e0a"}:{value:e+1,label:"".concat(e+1,"\u4e2a\u6708\u4ee5\u4e0a")}})),Ce=function(e){var t=e.filename,n=e.data,r=Object(a.useState)(),c=Object(m.a)(r,2),o=c[0],u=c[1],i=Object(a.useState)(),s=Object(m.a)(i,2),f=s[0],d=s[1],v=Object(a.useState)({value:"\u5168\u9009",label:"\u5168\u9009"}),p=Object(m.a)(v,2),h=p[0],E=p[1],b=Object(a.useState)({value:"\u5168\u9009",label:"\u5168\u9009"}),g=Object(m.a)(b,2),j=g[0],O=g[1],y=Object(a.useState)(""),x=Object(m.a)(y,2),S=x[0],w=x[1],D=Object(a.useState)(),F=Object(m.a)(D,2),C=F[0],M=F[1],k=Object(a.useState)(),_=Object(m.a)(k,2),P=(_[0],_[1]),R=Object(a.useState)(),Y=Object(m.a)(R,2),T=Y[0],I=Y[1],L=Object(a.useState)(new Date),U=Object(m.a)(L,2),W=U[0],J=U[1],H=Object(a.useState)(new Date),$=Object(m.a)(H,2),q=$[0],G=$[1],K=Object(a.useState)(Fe[0]),Q=Object(m.a)(K,2),V=Q[0],X=Q[1];Object(A.registerLocale)("zhCN",B.a);var Z=function(e){var t=e.value,n=e.onClick;return l.a.createElement(ce,{onClick:n},t)};Object(a.useEffect)((function(){if("undefined"!==typeof n){var e=[],t=[],a=[],l=[];n.forEach((function(n){var r={};if(t.some((function(e){return e.value===n["\u4e1a\u52a1\u5458"]}))||t.push({value:n["\u4e1a\u52a1\u5458"],label:n["\u4e1a\u52a1\u5458"]}),a.includes(n["\u5bf9\u8d26\u5355\u8d26\u671f"])||a.push(new Date(n["\u5bf9\u8d26\u5355\u8d26\u671f"])),e.some((function(e){return e.value===n["\u5ba2\u6237\u540d\u79f0"]}))){var c=l.findIndex((function(e){return e["\u5ba2\u6237\u540d\u79f0"]===n["\u5ba2\u6237\u540d\u79f0"]}));(void 0===l[c]["\u5bf9\u8d26\u5355\u8d26\u671f"]||void 0!==n["\u5bf9\u8d26\u5355\u8d26\u671f"]&&l[c]["\u5bf9\u8d26\u5355\u8d26\u671f"]<n["\u5bf9\u8d26\u5355\u8d26\u671f"])&&(l[c]["\u5bf9\u8d26\u5355\u8d26\u671f"]=n["\u5bf9\u8d26\u5355\u8d26\u671f"])}else e.push({value:n["\u5ba2\u6237\u540d\u79f0"],label:n["\u5ba2\u6237\u540d\u79f0"]}),r={"\u5ba2\u6237\u540d\u79f0":n["\u5ba2\u6237\u540d\u79f0"],"\u4e1a\u52a1\u5458":n["\u4e1a\u52a1\u5458"],"\u5bf9\u8d26\u5355\u8d26\u671f":n["\u5bf9\u8d26\u5355\u8d26\u671f"]},l.push(r)})),M(l),console.log("cleanedData",l),e.unshift({value:"\u5168\u9009",label:"\u5168\u9009"}),t.unshift({value:"\u5168\u9009",label:"\u5168\u9009"}),console.log("mindate",new Date(Math.min.apply(null,a))),J(new Date(Math.min.apply(null,a))),d(t),u(e)}}),[n]);return l.a.createElement(te,null,l.a.createElement(ne,null,l.a.createElement(z,null),l.a.createElement("p",null,t.replace(".xlsx",""))),l.a.createElement(ae,null,l.a.createElement(le,null,l.a.createElement("div",null,l.a.createElement("div",{style:{marginBottom:"1rem"}},l.a.createElement("h2",null,"\u4e1a\u52a1\u5458"),l.a.createElement(de.a,{options:f,value:j,onChange:function(e){O(e)}})),l.a.createElement("div",{style:{marginBottom:"1rem"}},l.a.createElement("h2",null,"\u5ba2\u6237"),l.a.createElement(de.a,{options:o,value:h,onChange:function(e){E(e)}})),l.a.createElement("div",null,l.a.createElement("h2",null,"\u672a\u56de\u6536\u65e5\u671f"),l.a.createElement(de.a,{options:Fe,value:V,onChange:function(e){X(e)}}))),l.a.createElement("div",null,l.a.createElement(se,null,S),l.a.createElement(ue,{onClick:function(){if(void 0===j||""===j.value||void 0===h||""===h.value){var e="";return void 0!==j&&""!==j.value||(e+="\u8bf7\u9009\u62e9\u4e1a\u52a1\u5458; "),void 0!==h&&""!==h.value||(e+="\u8bf7\u9009\u62e9\u5ba2\u6237; "),void w(e)}w("");var t=new Date(q.getFullYear(),q.getMonth(),1);t.setMonth(t.getMonth()+1);var n=C.filter((function(e){var t=!1;t="\u5168\u9009"===j.value&&"\u5168\u9009"===h.value||("\u5168\u9009"===j.value&&"\u5168\u9009"!==h.value?e["\u5ba2\u6237\u540d\u79f0"]===h.value:"\u5168\u9009"!==j.value&&"\u5168\u9009"===h.value?e["\u4e1a\u52a1\u5458"]===j.value:e["\u4e1a\u52a1\u5458"]===j.value&&e["\u5ba2\u6237\u540d\u79f0"]===h.value);var n=0;return void 0===e["\u5bf9\u8d26\u5355\u8d26\u671f"]?(console.log("\u6ca1\u6709",e),n=-1):n=12*(q.getFullYear()-new Date(e["\u5bf9\u8d26\u5355\u8d26\u671f"]).getFullYear())+q.getMonth()-new Date(e["\u5bf9\u8d26\u5355\u8d26\u671f"]).getMonth(),!(!(-1===n||n>=V.value)||!t)})),a=[];n.length>0&&n.map((function(e){var t=void 0===e["\u5bf9\u8d26\u5355\u8d26\u671f"]?-1:12*(q.getFullYear()-new Date(e["\u5bf9\u8d26\u5355\u8d26\u671f"]).getFullYear())+q.getMonth()-new Date(e["\u5bf9\u8d26\u5355\u8d26\u671f"]).getMonth(),n={"\u4e1a\u52a1\u5458":e["\u4e1a\u52a1\u5458"],"\u5ba2\u6237\u540d\u79f0":e["\u5ba2\u6237\u540d\u79f0"],"\u672a\u56de\u6536\u671f\u6570":-1===t?"1\u5e74\u4ee5\u4e0a":"".concat(t,"\u4e2a\u6708")};a.push(n)})),console.log("pData",a),I(a),P(n)},color:"calc"}," ","\u8ba1\u7b97"," "))),l.a.createElement(re,null,l.a.createElement("h2",null,"\u9009\u62e9\u622a\u6b62\u6708\u4efd"),l.a.createElement(N.a,{selected:q,onChange:function(e){G(e)},minDate:W,dateFormat:"MM/yyyy",showMonthYearPicker:!0,locale:"zhCN",customInput:l.a.createElement(Z,null)}))),l.a.createElement(oe,null,l.a.createElement(De,{printData:T,client:h.value,sale:j.value,month:q,recycleMonth:V}),l.a.createElement(ie,{onClick:function(){if(""!==T){var e={Sheets:{data:pe.utils.json_to_sheet(T)},SheetNames:["data"]},t=pe.write(e,{bookType:"xlsx",type:"array"}),n=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),a="\u5ba2\u6237".concat(h.value,"_\u4e1a\u52a1\u5458",j.value);ve.saveAs(n,a+".xlsx")}else alert("\u65e0\u6570\u636e")}}," \u5bfc\u51faexcel\u6587\u4ef6")))},Me=function(){var e=Object(a.useState)(),t=Object(m.a)(e,2),n=t[0],r=t[1],c=Object(a.useCallback)((function(e){var t=e[0];if(t){t.name;var n=new FileReader;n.onload=function(e){var t=e.target.result,n=pe.read(t,{type:"binary",cellDates:!0}),a=n.SheetNames,l=pe.utils.sheet_to_json(n.Sheets[a[0]],{dateNF:"mm/dd/yyyy;@"});r(l),console.log("data",l)},n.readAsBinaryString(t)}}),[]),o=Object(f.a)({onDrop:c,accept:".xlsx"}),u=o.isDragActive,i=o.getRootProps,s=o.getInputProps,d=(o.isDragReject,o.isDragAccepted,o.acceptedFiles);o.rejectedFiles;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h1",null,"\u672a\u56de\u6536\u5bf9\u8d26\u5355"),l.a.createElement(Z,i(),l.a.createElement("input",s()),!u&&"\u70b9\u51fb\u8fd9\u91cc\u6216\u8005\u62d6\u62fd\u6587\u4ef6\u81f3\u8fd9\u91cc\u8fdb\u884c\u4e0a\u4f20",u&&"\u653e\u4e0b\u6587\u4ef6"),d.length>0&&l.a.createElement(Ce,{filename:d[0].name,data:n}))};function ke(){var e=Object(o.a)(["\n  display: flex;\n  margin: 0;\n  padding: 0;\n\n  a {\n    text-decoration: none;\n  }\n\n  li {\n    color: #61988e;\n    border: 2px solid #61988e;\n    border-radius: 2px;\n    padding: 0.5rem 1rem;\n    margin: 0 -1px;\n    font-size: 1rem;\n    position: relative;\n    list-style: none;\n  }\n\n  .active {\n    li {\n      background-color: #61988e;\n      color: #fff;\n    }\n  }\n"]);return ke=function(){return e},e}var _e=s.a.ul(ke());function ze(){return l.a.createElement(u.a,{basename:"/wz-excel-process"},l.a.createElement("div",null,l.a.createElement(_e,null,l.a.createElement(u.b,{to:"/"},l.a.createElement("li",null,"\u94fa\u5e95\u7edf\u8ba1")),l.a.createElement(u.b,{to:"/dz"},l.a.createElement("li",null,"\u5bf9\u8d26")),l.a.createElement(u.b,{to:"/recycle"},l.a.createElement("li",null,"\u672a\u56de\u6536\u8d26\u5355"))),l.a.createElement(i.c,null,l.a.createElement(i.a,{exact:!0,path:"/",element:l.a.createElement(be,null)}),l.a.createElement(i.a,{path:"/dz",element:l.a.createElement(Se,null)}),l.a.createElement(i.a,{path:"/recycle",element:l.a.createElement(Me,null)}))))}var Ae=function(){return l.a.createElement(je,null,l.a.createElement(ge,null),l.a.createElement(ze,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(Ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},67:function(e,t,n){},70:function(e,t){},86:function(e,t,n){e.exports=n(158)},91:function(e,t,n){},99:function(e,t){}},[[86,1,2]]]);
//# sourceMappingURL=main.e2270438.chunk.js.map