{"version":3,"sources":["elements/StyledElements.js","components/MyDropzone.js","components/Header.js","components/Layout.js","images/excel.svg","components/Results.js","components/FileProcess.js","App.js","serviceWorker.js","index.js"],"names":["LayoutWrapper","styled","div","DropzoneWrapper","props","getColor","isDragAccept","isDragReject","isDragActive","FileProcessWrapper","FilenameWrapper","FilterWrapper","FilterTextWrapper","FilterDateWrapper","FilterMonthSelector","button","ResultWrapper","CalcButton","ExportButton","ErrorMessage","ResultsHeader","ResultsTable","table","MyDropzone","useState","data","setData","onDrop","useCallback","acceptedFiles","f","name","reader","FileReader","onload","evt","bstr","target","result","wb","XLSX","type","cellDates","wsnames","SheetNames","sheet_to_json","Sheets","dateNF","readAsBinaryString","useDropzone","accept","getRootProps","getInputProps","isDragAccepted","rejectedFiles","length","filename","Header","style","fontSize","color","fontWeight","Layout","children","_extends","Object","assign","i","arguments","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","_ref3","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","_ref","svgRef","title","id","x","y","viewBox","enableBackground","xmlSpace","ref","fill","d","ForwardRef","forwardRef","Results","filteredData","client","sale","month","cleanData","setCleanData","useEffect","brandlist","map","item","some","e","findIndex","temp","品牌","品种","单价","数量","金额","push","total","find","sort","a","b","localeCompare","undefined","getFullYear","getMonth","toFixed","FileProcess","clients","setClients","sales","setSales","Date","minDate","setMinDate","maxDate","setMaxDate","value","label","resultClient","setResultClient","resultSale","setResultSale","resultMonth","setResultMonth","currentClient","setCurrentClient","currentSale","setCurrentSale","errorMessage","setErrorMessage","setFilteredData","printData","setPrintData","setMonth","registerLocale","zhCN","CustomInput","onClick","clientlist","salelist","datelist","includes","unshift","Math","min","max","replace","marginBottom","options","onChange","console","log","msg","newMonth","filteredDate","filter","num","amount","pdata","Number","parseFloat","客户名","print_year","print_month","selected","date","dateFormat","showMonthYearPicker","locale","customInput","json_to_sheet","excelBuffer","bookType","Blob","concat","FileSaver","alert","App","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.0783f362.chunk.js","sourcesContent":["import styled from \"styled-components\";\n\nexport const LayoutWrapper = styled.div`\n  @import url(\"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;400;700&display=swap\");\n  height: 100vh;\n  padding: 5rem 10rem;\n  font-family: \"Noto Sans SC\", sans-serif;\n`;\n\nexport const DropzoneWrapper = styled.div`\n  input {\n    width: 100%;\n    height: 100%;\n  }\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 3rem;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ${props => getColor(props)};\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  cursor: pointer;\n  transition: border 0.24s ease-in-out;\n`;\n\nconst getColor = props => {\n  if (props.isDragAccept) {\n    return \"#00e676\";\n  }\n  if (props.isDragReject) {\n    return \"#ff1744\";\n  }\n  if (props.isDragActive) {\n    return \"#2196f3\";\n  }\n  return \"#eeeeee\";\n};\n\nexport const FileProcessWrapper = styled.div`\n  padding: 3rem 0;\n`;\n\nexport const FilenameWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  height: 2.5rem;\n  padding: 2rem;\n  background: #fafafa;\n  align-items: center;\n  svg {\n    height: 100%;\n    width: 4rem;\n  }\n  p {\n    font-weight: bold;\n    font-size: 2rem;\n    color: #2e7d32;\n  }\n`;\n\nexport const FilterWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  background: #eef4ee;\n  height: 23rem;\n  justify-content: start;\n  color: #575757;\n  padding: 2rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n`;\n\nexport const FilterTextWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  margin-right: 5rem;\n  width: 20rem;\n`;\n\nexport const FilterDateWrapper = styled.div`\n  width: 25rem;\n`;\n\nexport const FilterMonthSelector = styled.button`\n  font-family: \"Noto Sans SC\", sans-serif;\n  padding: 0.5rem 1.5rem;\n  font-size: 1rem;\n  border: none;\n  background: #61988e;\n  color: white;\n  cursor: pointer;\n  transition: all 0.5s;\n  &:active,\n  :focus,\n  :hover {\n    background: #2f5f56;\n  }\n`;\n\nexport const ResultWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  background: #dff2df;\n  justify-content: start;\n  color: #575757;\n  padding: 3rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n`;\n\nexport const CalcButton = styled.button`\n  padding: 0.6rem 1.5rem;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n`;\n\nexport const ExportButton = styled.button`\n  padding: 0.6rem 1.2rem;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n  margin-top: 1rem;\n`;\n\nexport const ErrorMessage = styled.div`\n  padding: 2rem 0rem;\n  font-weight: bolder;\n  color: #ed5757;\n`;\n\nexport const ResultsHeader = styled.div`\n  display: flex;\n  flex-direction: column;\n  h2 {\n    font-size: 1.75rem;\n  }\n  h3 {\n    font-weight: normal;\n  }\n\n  span {\n    margin-right: 3rem;\n  }\n`;\n\nexport const ResultsTable = styled.table`\n  border-collapse: collapse;\n  width: 100%;\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);\n\n  td,\n  th {\n    border: 2px solid #eef4ee;\n    text-align: left;\n    padding: 1.5rem;\n  }\n\n  th {\n    font-size: 1.5rem;\n  }\n\n  tr {\n    background-color: #fff;\n  }\n  tr:nth-child(even) {\n    background-color: #eef4ee;\n  }\n`;\n","import React, { useCallback, useState } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { FileProcess } from \"../components\";\nimport { DropzoneWrapper } from \"../elements/StyledElements\";\nimport * as XLSX from \"xlsx\";\n\nexport const MyDropzone = () => {\n  const [data, setData] = useState();\n\n  const onDrop = useCallback(acceptedFiles => {\n    var f = acceptedFiles[0];\n    if (!f) {\n      return;\n    }\n    var name = f.name;\n    const reader = new FileReader();\n    reader.onload = evt => {\n      // evt = on_file_select event\n      /* Parse data */\n      const bstr = evt.target.result;\n      // var length = bstr.byteLength;\n      // var binary = \"\";\n      // for (var i = 0; i < length; i++) {\n      //   binary += String.fromCharCode(bstr[i]);\n      // }\n\n      const wb = XLSX.read(bstr, {\n        type: \"binary\",\n        cellDates: true\n      });\n      /* Get worksheets */\n      const wsnames = wb.SheetNames;\n\n      /* Convert to json */\n      const data = XLSX.utils.sheet_to_json(wb.Sheets[wsnames[0]], {\n        dateNF: \"mm/dd/yyyy;@\"\n      });\n      /* Update state */\n      setData(data);\n    };\n    reader.readAsBinaryString(f);\n  }, []);\n\n  const {\n    isDragActive,\n    getRootProps,\n    getInputProps,\n    isDragReject,\n    isDragAccepted,\n    acceptedFiles,\n    rejectedFiles\n  } = useDropzone({\n    onDrop,\n    accept: \".xlsx\"\n  });\n\n  return (\n    <>\n      <DropzoneWrapper {...getRootProps()}>\n        <input {...getInputProps()} />\n        {!isDragActive && \"点击这里或者拖拽文件至这里进行上传\"}\n        {isDragActive && \"放下文件\"}\n      </DropzoneWrapper>\n      {acceptedFiles.length > 0 && (\n        <FileProcess filename={acceptedFiles[0].name} data={data} />\n      )}\n    </>\n  );\n};\n","import React from \"react\";\n\nexport function Header() {\n  return (\n    <div>\n      <h1 style={{ fontSize: \"3rem\" }}>铺底统计</h1>\n      <h3 style={{ color: \"#000\", fontWeight: \"normal\" }}>\n        亲爱的王舟女士定制款\n      </h3>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { LayoutWrapper } from \"../elements/StyledElements\";\n\nexport const Layout = ({ children }) => {\n  return <LayoutWrapper>{children}</LayoutWrapper>;\n};\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref6 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref7 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref8 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref9 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref10 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref11 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref12 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref13 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref14 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref15 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar _ref16 = /*#__PURE__*/React.createElement(\"g\", null);\n\nvar SvgExcel = function SvgExcel(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    style: {\n      enableBackground: \"new 0 0 512 512\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", null, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#ECEFF1\"\n    },\n    d: \"M496,432.011H272c-8.832,0-16-7.168-16-16s0-311.168,0-320s7.168-16,16-16h224 c8.832,0,16,7.168,16,16v320C512,424.843,504.832,432.011,496,432.011z\"\n  }), /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,176.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,176.011,336,176.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,240.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,240.011,336,240.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,304.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,304.011,336,304.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M336,368.011h-64c-8.832,0-16-7.168-16-16s7.168-16,16-16h64c8.832,0,16,7.168,16,16 S344.832,368.011,336,368.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,176.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,176.011,432,176.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,240.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,240.011,432,240.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,304.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,304.011,432,304.011z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#388E3C\"\n    },\n    d: \"M432,368.011h-32c-8.832,0-16-7.168-16-16s7.168-16,16-16h32c8.832,0,16,7.168,16,16 S440.832,368.011,432,368.011z\"\n  })), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#2E7D32\"\n    },\n    d: \"M282.208,19.691c-3.648-3.04-8.544-4.352-13.152-3.392l-256,48C5.472,65.707,0,72.299,0,80.011v352 c0,7.68,5.472,14.304,13.056,15.712l256,48c0.96,0.192,1.952,0.288,2.944,0.288c3.712,0,7.328-1.28,10.208-3.68 c3.68-3.04,5.792-7.584,5.792-12.32v-448C288,27.243,285.888,22.731,282.208,19.691z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: \"#FAFAFA\"\n    },\n    d: \"M220.032,309.483l-50.592-57.824l51.168-65.792c5.44-6.976,4.16-17.024-2.784-22.464 c-6.944-5.44-16.992-4.16-22.464,2.784l-47.392,60.928l-39.936-45.632c-5.856-6.72-15.968-7.328-22.56-1.504 c-6.656,5.824-7.328,15.936-1.504,22.56l44,50.304L83.36,310.187c-5.44,6.976-4.16,17.024,2.784,22.464 c2.944,2.272,6.432,3.36,9.856,3.36c4.768,0,9.472-2.112,12.64-6.176l40.8-52.48l46.528,53.152 c3.168,3.648,7.584,5.504,12.032,5.504c3.744,0,7.488-1.312,10.528-3.968C225.184,326.219,225.856,316.107,220.032,309.483z\"\n  }), _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16);\n};\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(SvgExcel, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/excel.c59164de.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useState } from \"react\";\nimport {\n  ResultsHeader,\n  ResultsTable,\n  FilterMonthSelector\n} from \"../elements/StyledElements\";\n\nexport const Results = ({ filteredData, client, sale, month }) => {\n  const [cleanData, setCleanData] = useState([]);\n  //   console.log(filteredData);\n\n  useEffect(() => {\n    if (typeof filteredData !== \"undefined\") {\n      let brandlist = [];\n      filteredData.map(item => {\n        if (\n          !brandlist.some(\n            e => e[\"品种\"] === item[\"品种\"] && e[\"单价\"] === item[\"单价\"]\n          ) &&\n          item[\"客户名\"] !== \"累计\"\n        ) {\n          let temp = {\n            品牌: item[\"品牌\"],\n            品种: item[\"品种\"],\n            单价: item[\"单价\"],\n            数量: item[\"数量\"],\n            金额: item[\"金额\"]\n          };\n          brandlist.push(temp);\n        } else if (item[\"客户名\"] !== \"累计\") {\n          let i = brandlist.findIndex(\n            e => e[\"品种\"] === item[\"品种\"] && e[\"单价\"] === item[\"单价\"]\n          );\n          let temp = brandlist[i];\n          temp[\"数量\"] += item[\"数量\"];\n          temp[\"金额\"] += item[\"金额\"];\n          brandlist[i] = temp;\n        }\n      });\n      //   console.log(brandlist);\n      const total = filteredData.find(item => item[\"客户名\"] === \"累计\");\n      //   console.log(total);\n\n      brandlist.sort((a, b) => {\n        if (a[\"品牌\"].localeCompare(b[\"品牌\"], \"zh\") == 1) {\n          return 1;\n        } else if (a[\"品牌\"].localeCompare(b[\"品牌\"], \"zh\") == -1) {\n          return -1;\n        }\n\n        return a[\"品种\"].localeCompare(b[\"品种\"], \"zh\");\n      });\n      brandlist.push({\n        品牌: \"累计\",\n        数量: total[\"数量\"],\n        金额: total[\"金额\"]\n      });\n      setCleanData(brandlist);\n    }\n  }, [filteredData]);\n\n  return (\n    <div>\n      {(() => {\n        if (\n          client === undefined ||\n          sale === undefined ||\n          filteredData === undefined\n        ) {\n          return;\n        }\n        if (filteredData.length === 0) {\n          return <p>无数据</p>;\n        }\n        return (\n          <>\n            <ResultsHeader>\n              <h2>结果</h2>\n              <h3>\n                <span>业务员：{sale}</span>\n                <span>客户：{client}</span>\n                <span>\n                  截止至: {month.getFullYear()}年{month.getMonth() + 1}月\n                </span>\n              </h3>\n            </ResultsHeader>\n            <ResultsTable>\n              <tr>\n                <th>品牌</th>\n                <th>品种</th>\n                <th>单价</th>\n                <th>数量</th>\n                <th>金额</th>\n              </tr>\n              {cleanData.map(item => {\n                if (item[\"数量\"] !== 0)\n                  return (\n                    <tr>\n                      <td>{item[\"品牌\"]}</td>\n                      <td>{item[\"品种\"]}</td>\n                      <td>{item[\"单价\"]}</td>\n                      <td>{item[\"数量\"]}</td>\n                      <td>{item[\"金额\"].toFixed(2)}</td>\n                    </tr>\n                  );\n              })}\n            </ResultsTable>\n          </>\n        );\n      })()}\n    </div>\n  );\n};\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { ReactComponent as ExcelSvg } from \"../images/excel.svg\";\nimport DatePicker, { registerLocale, setDefaultLocale } from \"react-datepicker\";\nimport zhCN from \"date-fns/locale/zh-CN\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport \"./monthpicker.css\";\nimport {\n  FilterWrapper,\n  FilterTextWrapper,\n  ResultWrapper,\n  CalcButton,\n  ExportButton,\n  FilterDateWrapper,\n  ErrorMessage,\n  FilterMonthSelector\n} from \"../elements/StyledElements\";\nimport Select from \"react-select\";\nimport {\n  FileProcessWrapper,\n  FilenameWrapper\n} from \"../elements/StyledElements\";\nimport * as FileSaver from \"file-saver\";\nimport * as XLSX from \"xlsx\";\nimport \"react-date-range/dist/styles.css\"; // main css file\nimport \"react-date-range/dist/theme/default.css\"; // theme css file\nimport { Results } from \"./Results\";\n\nexport const FileProcess = ({ filename, data }) => {\n  const [clients, setClients] = useState();\n  const [sales, setSales] = useState();\n  const [minDate, setMinDate] = useState(new Date());\n  const [maxDate, setMaxDate] = useState(new Date());\n  const [resultClient, setResultClient] = useState({ value: \"\", label: \"\" });\n  const [resultSale, setResultSale] = useState({ value: \"\", label: \"\" });\n  const [resultMonth, setResultMonth] = useState();\n  const [currentClient, setCurrentClient] = useState({ value: \"\", label: \"\" });\n  const [currentSale, setCurrentSale] = useState({ value: \"\", label: \"\" });\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [filteredData, setFilteredData] = useState();\n  const [printData, setPrintData] = useState();\n  const [month, setMonth] = useState(new Date());\n  registerLocale(\"zhCN\", zhCN);\n\n  const [totalNum, setTotalNum] = useState(0);\n  const [totalAmount, setTotalAmount] = useState(0);\n  //   console.log(data);\n\n  const CustomInput = ({ value, onClick }) => (\n    <FilterMonthSelector onClick={onClick}>{value}</FilterMonthSelector>\n  );\n\n  const handleMonthChange = newValue => {\n    setMonth(newValue);\n  };\n\n  const handleClientChange = currentClient => {\n    setCurrentClient(currentClient);\n  };\n\n  const handlesaleChange = currentSale => {\n    setCurrentSale(currentSale);\n  };\n\n  useEffect(() => {\n    if (typeof data !== \"undefined\") {\n      let clientlist = [];\n      let salelist = [];\n      let datelist = [];\n      data.map(item => {\n        if (!clientlist.some(e => e.value === item[\"客户名\"])) {\n          clientlist.push({ value: item[\"客户名\"], label: item[\"客户名\"] });\n        }\n        if (!salelist.some(e => e.value === item[\"业务员\"])) {\n          salelist.push({ value: item[\"业务员\"], label: item[\"业务员\"] });\n        }\n        if (!datelist.includes(item[\"日期\"])) {\n          datelist.push(new Date(item[\"日期\"]));\n        }\n      });\n      clientlist.unshift({\n        value: \"全选\",\n        label: \"全选\"\n      });\n      salelist.unshift({\n        value: \"全选\",\n        label: \"全选\"\n      });\n      setSales(salelist);\n      setClients(clientlist);\n      setMinDate(new Date(Math.min.apply(null, datelist)));\n      setMaxDate(new Date(Math.max.apply(null, datelist)));\n      setMonth(new Date(Math.min.apply(null, datelist)));\n    }\n  }, [data]);\n\n  const calcFunc = () => {\n    console.log(data);\n    console.log(currentSale);\n    console.log(currentClient);\n    console.log(month);\n\n    if (\n      currentSale === undefined ||\n      currentSale[\"value\"] === \"\" ||\n      currentClient === undefined ||\n      currentClient[\"value\"] === \"\"\n    ) {\n      let msg = \"\";\n      if (currentSale === undefined || currentSale[\"value\"] === \"\") {\n        msg += \"请选择业务员; \";\n      }\n      if (currentClient === undefined || currentClient[\"value\"] === \"\") {\n        msg += \"请选择客户; \";\n      }\n      setErrorMessage(msg);\n      return;\n    }\n\n    setErrorMessage(\"\");\n    let newMonth = new Date(month.getFullYear(), month.getMonth(), 1);\n    newMonth.setMonth(newMonth.getMonth() + 1);\n    console.log(newMonth);\n\n    let filteredDate = data.filter(item => {\n      if (item[\"日期\"] < newMonth) {\n        if (\n          currentSale[\"value\"] === \"全选\" &&\n          currentClient[\"value\"] === \"全选\"\n        ) {\n          return true;\n        } else if (\n          currentSale[\"value\"] === \"全选\" &&\n          currentClient[\"value\"] !== \"全选\"\n        ) {\n          if (item[\"客户名\"] === currentClient[\"value\"]) {\n            return true;\n          }\n          return false;\n        } else if (\n          currentSale[\"value\"] !== \"全选\" &&\n          currentClient[\"value\"] === \"全选\"\n        ) {\n          if (item[\"业务员\"] === currentSale[\"value\"]) {\n            return true;\n          }\n          return false;\n        } else {\n          if (\n            item[\"业务员\"] === currentSale[\"value\"] &&\n            item[\"客户名\"] === currentClient[\"value\"]\n          ) {\n            return true;\n          }\n          return false;\n        }\n      } else {\n        console.log(item[\"日期\"] + \"not in time\");\n        return false;\n      }\n    });\n\n    let num = 0;\n    let amount = 0.0;\n    let pdata = [];\n\n    if (filteredDate.length > 0) {\n      filteredDate.map(item => {\n        if (typeof item[\"数量\"] === \"number\") {\n          num += item[\"数量\"];\n        }\n        amount += Number.parseFloat(item[\"金额\"]);\n        let i = { ...item };\n        pdata.push(i);\n      });\n    }\n\n    filteredDate.push({ 客户名: \"累计\", 数量: num, 金额: amount });\n    pdata.push({ 客户名: \"累计\", 数量: num, 金额: amount });\n\n    if (pdata.length > 0) {\n      pdata.map(item => {\n        if (item[\"客户名\"] === \"累计\") return;\n        let print_year = item[\"日期\"].getFullYear();\n        let print_month = item[\"日期\"].getMonth();\n        item[\"日期\"] = print_year + \"年\" + print_month + \"月\";\n      });\n    }\n    setPrintData(pdata);\n    setFilteredData(filteredDate);\n\n    setResultClient(currentClient);\n    setResultSale(currentSale);\n    setResultMonth(month);\n\n    // console.log(filteredDate);\n  };\n\n  const exportToExcel = () => {\n    if (printData === \"\") {\n      alert(\"无数据\");\n      return;\n    }\n    const fileType =\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n    const fileExtension = \".xlsx\";\n    const ws = XLSX.utils.json_to_sheet(printData);\n    const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n    const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n    const data = new Blob([excelBuffer], { type: fileType });\n    const filename = \"客户\".concat(\n      currentClient[\"value\"],\n      \"_业务员\",\n      currentSale[\"value\"]\n    );\n    FileSaver.saveAs(data, filename + fileExtension);\n  };\n\n  return (\n    <FileProcessWrapper>\n      <FilenameWrapper>\n        <ExcelSvg />\n        <p>{filename.replace(\".xlsx\", \"\")}</p>\n      </FilenameWrapper>\n      <FilterWrapper>\n        <FilterTextWrapper>\n          <div>\n            <div style={{ marginBottom: \"3rem\" }}>\n              <h2>业务员</h2>\n              <Select\n                options={sales}\n                value={currentSale}\n                onChange={handlesaleChange}\n              />\n            </div>\n            <div>\n              <h2>客户</h2>\n              <Select\n                options={clients}\n                value={currentClient}\n                onChange={handleClientChange}\n              />\n            </div>\n          </div>\n          <div>\n            <ErrorMessage>{errorMessage}</ErrorMessage>\n            <CalcButton onClick={calcFunc} color={\"calc\"}>\n              {\" \"}\n              计算{\" \"}\n            </CalcButton>\n          </div>\n        </FilterTextWrapper>\n        <FilterDateWrapper>\n          <h2>选择截止月份</h2>\n          <DatePicker\n            selected={month}\n            onChange={date => handleMonthChange(date)}\n            dateFormat=\"MM/yyyy\"\n            showMonthYearPicker\n            maxDate={maxDate}\n            minDate={minDate}\n            locale=\"zhCN\"\n            customInput={<CustomInput />}\n          />\n        </FilterDateWrapper>\n      </FilterWrapper>\n      <ResultWrapper>\n        <Results\n          filteredData={filteredData}\n          client={resultClient[\"value\"]}\n          sale={resultSale[\"value\"]}\n          month={resultMonth}\n        />\n        <ExportButton onClick={exportToExcel}> 导出excel文件</ExportButton>\n      </ResultWrapper>\n    </FileProcessWrapper>\n  );\n};\n","import React from \"react\";\nimport { Header, Layout, MyDropzone } from \"./components\";\n\nfunction App() {\n  return (\n    <Layout>\n      <Header />\n      <MyDropzone />\n    </Layout>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}